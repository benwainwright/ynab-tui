{"version":3,"sources":["../../../../src/hooks/use-budget/use-budget.spec.ts"],"sourcesContent":["import { renderHook, waitFor } from '@testing-library/react'\nimport { useBudget } from './use-budget.ts'\nimport { useApi, useConfig } from '@hooks'\nimport { when } from 'vitest-when'\nimport { mock } from 'vitest-mock-extended'\nimport { API, BudgetsApi, BudgetSummary, BudgetSummaryResponse } from 'ynab'\nimport { getApi } from '@core'\n\nvi.mock('@hooks')\nvi.mock('@core')\n\nbeforeEach(() => {\n  vi.resetAllMocks()\n})\n\ndescribe('use budget', () => {\n  it('starts off as undefined then loads in the budget', async () => {\n    const mockAuthStrategy = vi.fn()\n\n    vi.mocked(useConfig).mockReturnValue({\n      apiAuthStrategy: mockAuthStrategy,\n    })\n\n    const mockBudgets = mock<BudgetsApi>()\n\n    const mockApi = mock<API>({\n      budgets: mockBudgets,\n    })\n\n    const budgetOne = mock<BudgetSummary>()\n    const budgetTwo = mock<BudgetSummary>()\n\n    const response = mock<BudgetSummaryResponse>({\n      data: {\n        budgets: [budgetOne, budgetTwo],\n      },\n    })\n\n    mockBudgets.getBudgets.mockResolvedValue(response)\n\n    vi.mocked(useApi).mockReturnValue({ api: mockApi })\n\n    const { result } = renderHook(() => useBudget())\n\n    expect(result.current.budget).toBeUndefined()\n\n    await waitFor(() => {\n      expect(result.current.budget).toEqual(budgetOne)\n    })\n  })\n})\n"],"names":["renderHook","waitFor","useBudget","useApi","useConfig","mock","vi","beforeEach","resetAllMocks","describe","it","mockAuthStrategy","fn","mocked","mockReturnValue","apiAuthStrategy","mockBudgets","mockApi","budgets","budgetOne","budgetTwo","response","data","getBudgets","mockResolvedValue","api","result","expect","current","budget","toBeUndefined","toEqual"],"mappings":"AAAA,SAASA,UAAU,EAAEC,OAAO,QAAQ,yBAAwB;AAC5D,SAASC,SAAS,0BAAyB;AAC3C,SAASC,MAAM,EAAEC,SAAS,QAAQ,cAAQ;AAE1C,SAASC,IAAI,QAAQ,uBAAsB;AAI3CC,GAAGD,IAAI,CAAC;AACRC,GAAGD,IAAI,CAAC;AAERE,WAAW;IACTD,GAAGE,aAAa;AAClB;AAEAC,SAAS,cAAc;IACrBC,GAAG,oDAAoD;QACrD,MAAMC,mBAAmBL,GAAGM,EAAE;QAE9BN,GAAGO,MAAM,CAACT,WAAWU,eAAe,CAAC;YACnCC,iBAAiBJ;QACnB;QAEA,MAAMK,cAAcX;QAEpB,MAAMY,UAAUZ,KAAU;YACxBa,SAASF;QACX;QAEA,MAAMG,YAAYd;QAClB,MAAMe,YAAYf;QAElB,MAAMgB,WAAWhB,KAA4B;YAC3CiB,MAAM;gBACJJ,SAAS;oBAACC;oBAAWC;iBAAU;YACjC;QACF;QAEAJ,YAAYO,UAAU,CAACC,iBAAiB,CAACH;QAEzCf,GAAGO,MAAM,CAACV,QAAQW,eAAe,CAAC;YAAEW,KAAKR;QAAQ;QAEjD,MAAM,EAAES,MAAM,EAAE,GAAG1B,WAAW,IAAME;QAEpCyB,OAAOD,OAAOE,OAAO,CAACC,MAAM,EAAEC,aAAa;QAE3C,MAAM7B,QAAQ;YACZ0B,OAAOD,OAAOE,OAAO,CAACC,MAAM,EAAEE,OAAO,CAACZ;QACxC;IACF;AACF"}