{"version":3,"sources":["../../../../src/hooks/use-budget/use-budget.spec.ts"],"sourcesContent":["import { renderHook, waitFor } from '@testing-library/react'\nimport { useBudget } from './use-budget.ts'\nimport { useConfig } from '@hooks'\nimport { when } from 'vitest-when'\nimport { mock } from 'vitest-mock-extended'\nimport { API, BudgetsApi, BudgetSummary, BudgetSummaryResponse } from 'ynab'\nimport { getApi } from '@core'\n\nvi.mock('@hooks')\nvi.mock('@core')\n\nbeforeEach(() => {\n  vi.resetAllMocks()\n})\n\ndescribe('use budget', () => {\n  it('starts off as undefined then loads in the budget', async () => {\n    const mockAuthStrategy = vi.fn()\n\n    vi.mocked(useConfig).mockReturnValue({\n      apiAuthStrategy: mockAuthStrategy,\n    })\n\n    const mockBudgets = mock<BudgetsApi>()\n\n    const mockApi = mock<API>({\n      budgets: mockBudgets,\n    })\n\n    const budgetOne = mock<BudgetSummary>()\n    const budgetTwo = mock<BudgetSummary>()\n\n    const response = mock<BudgetSummaryResponse>({\n      data: {\n        budgets: [budgetOne, budgetTwo],\n      },\n    })\n\n    mockBudgets.getBudgets.mockResolvedValue(response)\n\n    when(getApi).calledWith(mockAuthStrategy).thenResolve(mockApi)\n\n    const { result } = renderHook(() => useBudget())\n\n    expect(result.current.budget).toBeUndefined()\n\n    await waitFor(() => {\n      expect(result.current.budget).toEqual(budgetOne)\n    })\n  })\n})\n"],"names":["renderHook","waitFor","useBudget","useConfig","when","mock","getApi","vi","beforeEach","resetAllMocks","describe","it","mockAuthStrategy","fn","mocked","mockReturnValue","apiAuthStrategy","mockBudgets","mockApi","budgets","budgetOne","budgetTwo","response","data","getBudgets","mockResolvedValue","calledWith","thenResolve","result","expect","current","budget","toBeUndefined","toEqual"],"mappings":"AAAA,SAASA,UAAU,EAAEC,OAAO,QAAQ,yBAAwB;AAC5D,SAASC,SAAS,0BAAyB;AAC3C,SAASC,SAAS,QAAQ,cAAQ;AAClC,SAASC,IAAI,QAAQ,cAAa;AAClC,SAASC,IAAI,QAAQ,uBAAsB;AAE3C,SAASC,MAAM,QAAQ,sBAAO;AAE9BC,GAAGF,IAAI,CAAC;AACRE,GAAGF,IAAI,CAAC;AAERG,WAAW;IACTD,GAAGE,aAAa;AAClB;AAEAC,SAAS,cAAc;IACrBC,GAAG,oDAAoD;QACrD,MAAMC,mBAAmBL,GAAGM,EAAE;QAE9BN,GAAGO,MAAM,CAACX,WAAWY,eAAe,CAAC;YACnCC,iBAAiBJ;QACnB;QAEA,MAAMK,cAAcZ;QAEpB,MAAMa,UAAUb,KAAU;YACxBc,SAASF;QACX;QAEA,MAAMG,YAAYf;QAClB,MAAMgB,YAAYhB;QAElB,MAAMiB,WAAWjB,KAA4B;YAC3CkB,MAAM;gBACJJ,SAAS;oBAACC;oBAAWC;iBAAU;YACjC;QACF;QAEAJ,YAAYO,UAAU,CAACC,iBAAiB,CAACH;QAEzClB,KAAKE,QAAQoB,UAAU,CAACd,kBAAkBe,WAAW,CAACT;QAEtD,MAAM,EAAEU,MAAM,EAAE,GAAG5B,WAAW,IAAME;QAEpC2B,OAAOD,OAAOE,OAAO,CAACC,MAAM,EAAEC,aAAa;QAE3C,MAAM/B,QAAQ;YACZ4B,OAAOD,OAAOE,OAAO,CAACC,MAAM,EAAEE,OAAO,CAACb;QACxC;IACF;AACF"}